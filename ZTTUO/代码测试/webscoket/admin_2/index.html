<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="./jquery.min.js"></script>
  <style>
    div {
      border: 1px solid #000;
    }

    iframe {
      height: 500px;
      width: 500px;
    }
  </style>
  <script>
    var gui = require('nw.gui');
    gui.Screen.Init();
    var screens = gui.Screen.screens;
    var lastScreen = screens[screens.length - 1];
    var win = gui.Window.get();

    win.moveBy(lastScreen.bounds.x, lastScreen.bounds.y);
    win.enterFullscreen();

    win.on('resize', function () {
      setTimeout(' hexagon.init();', 1000);
    });

    var screenCB = {
      onDisplayAdded: function (screen) {
        var screens = gui.Screen.screens;
        var lastScreen = screens[screens.length - 1];
        win.leaveFullscreen();
        win.moveBy(lastScreen.bounds.x, lastScreen.bounds.y);
        win.enterFullscreen();
      }
    };

    gui.Screen.on('displayAdded', screenCB.onDisplayAdded);
  </script>
</head>

<body>
  <div></div>

  </iframe>

  <script>
    var div = document.querySelector('div')
    var scoket = new WebSocket('ws://localhost:3000')
    scoket.addEventListener('open', function () {
      console.log('链接成功')
      div.innerHTML = '链接成功' + `</br>`
    })

    scoket.addEventListener('message', function (e) {
      const msg = JSON.parse(e.data)
      const _type = JSON.parse(msg.data).type
      const _equipment = JSON.parse(msg.data).equipment
      const _url = JSON.parse(msg.data).url
      var dv = document.createElement("p")
      dv.innerHTML = _type + ' == ' + _equipment + ' == ' + _url
      div.appendChild(dv)

      if (_type == 'ifram' && _equipment == 'aviation') {
        console.log('展示网页')
        $('body').append(`<iframe id="inlineFrameExample" width="300" height="200" src="${_url}">`)
      }
    })
  </script>
</body>

</html>